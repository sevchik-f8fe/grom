# Изменения от Ивана Корниенко (имеются ссылки на файлы)

## Версия 1.2

Конечно! Составление подробного и структурированного чейнджлога — отличная практика. Вот полный список изменений для версии 1.2, с разделением на серверную и клиентскую части, как вы и просили.

**`### vite.config.js`**

- **`[CONFIG]`** Добавлена конфигурация `server.proxy`. Все запросы, начинающиеся с `/api`, теперь автоматически перенаправляются на backend-сервер (`http://localhost:3000`), что решило все ошибки `404 Not Found` при обращении к API.

**`### /src/main.jsx`**

- **`[NEW]`** Интегрирован новый компонент `<QuestStateLoader />` внутрь `Provider` и `PersistGate`. Это гарантирует, что при каждой загрузке приложения фронтенд будет синхронизировать свое состояние с бэкендом.

**`### /src/components/QuestStateLoader.jsx` (Новый файл)**

- **`[NEW]`** Создан новый "логический" компонент, который не имеет визуального представления.
- **`[FEATURE]`** При монтировании компонент выполняет `fetch`-запрос к новому эндпоинту `/api/quest/state`, получает актуальный номер этапа с сервера и обновляет глобальное хранилище Redux (`globalSlice`) с помощью `dispatch`.

**`### /src/globalSlice.js`**

- **`[NEW]`** В `initialState` добавлено новое поле `currentStage`.

- **`[NEW]`** Добавлен новый редьюсер `setCurrentStage`, который позволяет компоненту `QuestStateLoader` обновлять состояние квеста на всем приложении.

**`### /src/pages/QRPage/QRPage.jsx`**

- **`[FIX]`** Устранена ошибка `TypeError: Cannot read properties of undefined (reading 'trim')` путем добавления проверки на существование `result.data` перед обработкой.
- **`[FIX]`** Исправлена "гонка состояний" (многократное сканирование) путем внедрения флага `isProcessing` для блокировки сканера после первого успешного распознавания.
- **`[FIX]`** Решена проблема, при которой оверлей (`qr-cover`) блокировал работу сканера, путем добавления инлайн-стиля `style={{ pointerEvents: 'none' }}`.

**`### /src/pages/StagePage/StagePage.jsx`**

- **`[CRITICAL FIX]`** Из компонента была полностью удалена любая логика, изменяющая состояние (`dispatch`). Функция `clickHandle` теперь отвечает **только** за навигацию на страницу сканера, что устранило проблему преждевременного перехода на следующий этап.

**`### /src/pages/StagesPage/StagesPage.jsx`**

- **`[REFACTOR]`** Логика компонента полностью переписана для использования `currentStage` из `globalSlice` как единственного источника данных для отображения прогресса.
- **`[FEATURE]`** Реализована визуализация статуса этапов:
  - Пройденные этапы и линии после них окрашиваются.
  - Текущий активный этап подсвечивается.
  - Клик для перехода на страницу этапа работает только для текущего этапа.
- **`[FIX]`** Исправлена ошибка верстки, из-за которой 10-й этап прижимался к левому краю. Теперь для него рендерится пустой `div`-распорка для корректной работы `justify-content: space-between`.

## Версия 1.1

### [QR-сканеры](/src/pages/QRPage)

1. **[Собственно сканер](/src/pages/QRPage/QRPage.jsx)**

   - Добавлено ограничение кол-ва сканирований (1 раз в секунду)

   - Добавлена логика сканирования: если при сканировании оказывается только ссылка, то появляется pop-up окно, которое просит перейти на сайт. Если в обычном тексте находится ссылка, то она выделяется

2. Все страницы (изменения в [главном файле](/src/pages/QRPage/QRPage.jsx))

   - Добавлено ограничение сайта по ширине (теперь максимальная ширина, на которой отображается контент - 520px)

   - Если сайт открывается не на мобильном устройсте. то появляется надпись о том, что сайт стоит открывать на смартфоне

   - Действие не распространяется только на главную страницу и админку

3. Новых зависимостей нет

## Версия 1.0 (начальная)

### [QR-сканеры](/src/pages/QRPage)

1. **[Собственно сканер](/src/pages/QRPage/QRPage.jsx)** - новый файл:

   Был добавлен сканер, который временно принимает любые коды (пока я не видел, чтобы какие-то конкретные задания были в БД).

   Сайт практически полностью совпадает с дизайном (кроме того момента, что сканер чуть уже, чем на набросках).

   Также был добавлен хук, который позволяет выводить отсканированные данные на экран.

   Серьезных ошибок браузер не отображает.

2. **[Слайс к сканеру](/src/pages/QRPage/QRPage.jsx)** - новый файл

3. **[Страница ошибки](/src/pages/ErrorPage.jsx)** - новый файл

### Минорные изменения

1. **[Хуки](/src/hooks.js)**

   Добавлен уникальный бэкграунд к страницам (к странице ошибки и странице сканера)

2. **[Стили](/src/index.css)** - от 434 до

   Добавлены стили для всех новых страниц, которые сделал (с комментариями)

3. **[Страницы с конкретным этапом](/src/pages/StagePage/StagePage.jsx)**

   Теперь кнопка при нажатии отправляет на страницу сканера

4. **[Главный файл](/src/main.jsx)**

   Добавлены компоненты моих страниц, их редусеров и Redux Store

5. **[Картирка к сканеру](/src/assets/img/qr.svg)**

   Мною был незначительно переписан код, чтобы уменьшить пустое пространство.

6. **[Домашняя страница](/src/pages/HomePage/HomePage.jsx)**

   Везде, где возможно, изменены некоторые символы в тексте (например, символ "—" записан как "ndash;"), чтобы не возникало проблем с кодировкой

7. **[Страница с этапами](/src/pages/StagesPage/StagesPage.jsx)**

   Код в тех местах, где не работал или не использовался, был закомментирован

8. **Все новые зависимости были добавлены**
